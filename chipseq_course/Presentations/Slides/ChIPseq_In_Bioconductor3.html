<!DOCTYPE html>
<html>
  <head>
    <title></title>
    <meta charset="utf-8">
    <meta name="author" content="Rockefeller University, Bioinformatics Resource Centre" />
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link rel="stylesheet" href="metropolisCustom.css" type="text/css" />
    <link rel="stylesheet" href="metropolis-fontsCustom.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# ChIP-seq In Bioconductor part3
<html>
<div style="float:left">

</div>
<hr color='#EB811B' size=1px width=796px>
</html>
### Rockefeller University, Bioinformatics Resource Centre
### <a href="http://rockefelleruniversity.github.io/Bioconductor_Introduction/" class="uri">http://rockefelleruniversity.github.io/Bioconductor_Introduction/</a>

---





# Data

In todays session we will continue to review the Myc ChIPseq we were working on in our last sessions.

This include Myc ChIP-seq for MEL and Ch12 celllines.

Information and files for the [Myc ChIPseq in MEL cell line can be found here](https://www.encodeproject.org/experiments/ENCSR000EUA/)

Information and files for the [Myc ChIPseq in Ch12 cell line can be found here](https://www.encodeproject.org/experiments/ENCSR000ERN/)

&lt;!-- --- --&gt;

&lt;!-- # Data --&gt;

&lt;!-- We will be working with peak calls today, so we can download the MACS2 peak calls from the Encode website. --&gt;

&lt;!-- [Myc Mel Rep1](https://www.encodeproject.org/files/ENCFF363WUG/@@download/ENCFF363WUG.bed.gz) --&gt;

&lt;!-- [Myc Mel Rep2](https://www.encodeproject.org/files/ENCFF139JHS/@@download/ENCFF139JHS.bed.gz) --&gt;

&lt;!-- [Myc Ch12 Rep1](https://www.encodeproject.org/files/ENCFF160KXR/@@download/ENCFF160KXR.bed.gz) --&gt;

&lt;!-- [Myc Ch12 Rep2](https://www.encodeproject.org/files/ENCFF962BGJ/@@download/ENCFF962BGJ.bed.gz) --&gt;

---

# Data

I have provided peakcalls from MACS2 following the processing steps outlined in our last session.

Peak calls for Myc in MEL and Ch12 cellines can be found in 

**Data/peaks/**

* **Data/peaks/Mel_1_peaks.xls**
* **Data/peaks/Mel_2_peaks.xls**
* **Data/peaks/Ch12_1_peaks.xls**
* **Data/peaks/Ch12_1_peaks.xls**

---

# Annotation of peaks to genes.

In our last session we reviewed how we can [identify putative transciption factor binding sites using peak calling programs such as MACS2.](https://rockefelleruniversity.github.io/RU_ChIPseq/chipseq_course/Presentations/Slides/ChIPseq_In_Bioconductor2.html#45).

Since transcription factors, as suggested in name, may regulate the transcription of their target genes, we used the **ChIPseeker package** to associate our peaks, representing potential transcription factor binding events, to their overlapping or closest mm10 genes.

---

# Annotation of peaks to genes.

To do this we first read in our peak calls and converted these to a GRanges object we can manipulate in R.


```r
library(GenomicRanges)
macsPeaks &lt;- "data/peaks/Mel_1_peaks.xls"
macsPeaks_DF &lt;- read.delim(macsPeaks,comment.char="#")
macsPeaks_GR &lt;- GRanges(
 seqnames=macsPeaks_DF[,"chr"],
 IRanges(macsPeaks_DF[,"start"],macsPeaks_DF[,"end"])
)
mcols(macsPeaks_GR) &lt;- macsPeaks_DF[,c("abs_summit", "fold_enrichment")]
macsPeaks_GR[1:3,]
```

```
## GRanges object with 3 ranges and 2 metadata columns:
##       seqnames             ranges strand | abs_summit fold_enrichment
##          &lt;Rle&gt;          &lt;IRanges&gt;  &lt;Rle&gt; |  &lt;integer&gt;       &lt;numeric&gt;
##   [1]     chr1 [4785370, 4785641]      * |    4785565         5.23296
##   [2]     chr1 [5082993, 5083216]      * |    5083122         4.26417
##   [3]     chr1 [7397557, 7398093]      * |    7397835          9.8458
##   -------
##   seqinfo: 21 sequences from an unspecified genome; no seqlengths
```

---

# Annotation of peaks to genes.

We then annotated our peaks to genes using the gene models stored in our Bioconductor TxDb package (here - TxDb.Mmusculus.UCSC.mm10.knownGene) and the **annotatePeak** function in the ChIPseeer package.


```r
library(TxDb.Mmusculus.UCSC.mm10.knownGene)
library(ChIPseeker)
peakAnno &lt;- annotatePeak(macsPeaks_GR, tssRegion=c(-1000, 1000), 
                         TxDb=TxDb.Mmusculus.UCSC.mm10.knownGene, 
                         annoDb="org.Mm.eg.db")
```

```
## &gt;&gt; preparing features information...		 2018-12-07 10:56:32 
## &gt;&gt; identifying nearest features...		 2018-12-07 10:56:33 
## &gt;&gt; calculating distance from peak to TSS...	 2018-12-07 10:56:34 
## &gt;&gt; assigning genomic annotation...		 2018-12-07 10:56:34 
## &gt;&gt; adding gene annotation...			 2018-12-07 10:56:48 
## &gt;&gt; assigning chromosome lengths			 2018-12-07 10:56:48 
## &gt;&gt; done...					 2018-12-07 10:56:48
```

```r
peakAnno
```

```
## Annotated peaks generated by ChIPseeker
## 13777/13777  peaks were annotated
## Genomic Annotation Summary:
##              Feature  Frequency
## 9           Promoter 46.4542353
## 4             5' UTR  0.2685635
## 3             3' UTR  1.3283008
## 1           1st Exon  0.6314873
## 7         Other Exon  1.9888219
## 2         1st Intron  9.7481309
## 8       Other Intron 15.4169993
## 6 Downstream (&lt;=3kb)  1.2702330
## 5  Distal Intergenic 22.8932278
```

---

# Annotation of peaks to genes.

This allowed us to produce a GRanges or data.frame of our peaks and their predicted target genes.


```r
annotatedPeaksGR &lt;- as.GRanges(peakAnno)
annotatedPeaksDF &lt;- as.data.frame(peakAnno)
annotatedPeaksDF[1:2,]
```

```
##   seqnames   start     end width strand abs_summit fold_enrichment
## 1     chr1 4785370 4785641   272      *    4785565         5.23296
## 2     chr1 5082993 5083216   224      *    5083122         4.26417
##   annotation geneChr geneStart geneEnd geneLength geneStrand geneId
## 1   Promoter       1   4773200 4785726      12527          2  27395
## 2   Promoter       1   5083086 5099777      16692          1 108664
##   transcriptId distanceToTSS            ENSEMBL  SYMBOL
## 1   uc007afd.3            85 ENSMUSG00000033845  Mrpl15
## 2   uc007afm.2             0 ENSMUSG00000033793 Atp6v1h
##                                          GENENAME
## 1             mitochondrial ribosomal protein L15
## 2 ATPase, H+ transporting, lysosomal V1 subunit H
```




---
#Geneset testing.

Transcription factors or epigenetic marks may act on specific sets of genes grouped by a common biological feature (shared Biological function, common regulation in RNAseq experiment etc).

A frequent step in ChIP-seq analysis is to test whether common gene sets are enriched for transcription factor binding or epigenetic marks.

Sources of well curated genesets include [GO consortium](http://geneontology.org/) (gene's function, biological process and cellular localisation), [REACTOME](http://www.reactome.org/) (Biological Pathways) and [MsigDB](http://software.broadinstitute.org/gsea/msigdb/) (Computationally and Experimentally derived).

---
#Gene Ontology

The [Gene Ontology consortium]((http://geneontology.org/)) aims to provide a comprehensive resource of the currently available knowledge regarding the functions of genes and gene products.

Functional categories of genes are broadly split into three main groups.

* **Molecular functions.** - Activity of a gene's protein product.
* **Biological processes.** - Role of gene's protein product.
* **Cellular components.** - Where in cell molecular function of protein product is performed.

---
#Gene Ontology

The three sub categories of gene ontology are arranged in nested, structured graph with gene sets at the top of graph representing more general terms and those at the bottom more specific terms.

![](imgs/GO_Graph.png)

---
#Gene Ontology in Bioconductor

We have access to both the annotation of genes to GO terms and the GO graph structure from our Bioconductor annotation packages.

* The **Org.db** packages contain annotation of genes to GO terms.
* The **GO.db** package holds information on GO structure and term details.

---
#Gene Ontology

To access information on genes GO terms we can use the familiar [**select** accessor](https://rockefelleruniversity.github.io/Bioconductor_Introduction/r_course/presentations/slides/GenomicFeatures_In_Bioconductor.html#51) to access the **GO** column.


```r
library(org.Mm.eg.db)
genesOInterest &lt;- annotatedPeaksGR$SYMBOL
myAnnotation &lt;- select(org.Mm.eg.db, keys = genesOInterest[1:3], keytype = "SYMBOL", 
                       columns = c("SYMBOL", "GO"))
```

```
## 'select()' returned 1:many mapping between keys and columns
```

```r
myAnnotation[1:3,]
```

```
##   SYMBOL         GO EVIDENCE ONTOLOGY
## 1 Mrpl15 GO:0000002      TAS       BP
## 2 Mrpl15 GO:0003723      ISO       MF
## 3 Mrpl15 GO:0003735      IBA       MF
```


---
#Gene Ontology

We can access more descriptive information on these GO terms from the GO.db package.


```r
library(GO.db)
goOInterest &lt;- myAnnotation$GO
goAnnotation &lt;- select(GO.db, keys = goOInterest, keytype = "GOID", 
                       columns = c("GOID", "TERM"))
```

```
## 'select()' returned many:1 mapping between keys and columns
```

```r
goAnnotation[1:3,]
```

```
##         GOID                               TERM
## 1 GO:0000002   mitochondrial genome maintenance
## 2 GO:0003723                        RNA binding
## 3 GO:0003735 structural constituent of ribosome
```

---
#Gene Ontology

Finally we can merge data.frames to produce a useful table.


```r
annotationTable &lt;- merge(myAnnotation,goAnnotation,by.x="GO",by.y="GOID")
annotationTable[1:3,]
```

```
##           GO  SYMBOL EVIDENCE ONTOLOGY
## 1 GO:0000002  Mrpl15      TAS       BP
## 2 GO:0000221 Atp6v1h      IBA       CC
## 3 GO:0003723  Mrpl15      ISO       MF
##                                                    TERM
## 1                      mitochondrial genome maintenance
## 2 vacuolar proton-transporting V-type ATPase, V1 domain
## 3                                           RNA binding
```



---
#Reactome and KEGG

The [Reactome](http://www.reactome.org/) and [KEGG (Kyoto Encyclopedia of genes and genomes)](http://www.genome.jp/kegg/kegg2.html) contains information on genes' membership and roles in  molecular pathways.

These databases focus largely on metabolic and disease pathways, and allow us to investigate our genes in the context of not only functional roles but relative positions within pathways.


&lt;div align="center"&gt;
&lt;img src="imgs/map01100.png" alt="offset" height="300" width="600"&gt;
&lt;/div&gt;

---
#KEGG

To access information on genes KEGG terms we can extract from our **org.Mm.eg.db** packages as with GO. Here we will **PATH** column.


```r
library(org.Mm.eg.db)
genesOInterest &lt;- annotatedPeaksGR$SYMBOL
myAnnotation &lt;- select(org.Mm.eg.db, keys = genesOInterest[1:3], keytype = "SYMBOL", 
                       columns = c("SYMBOL", "PATH"))
```

```
## 'select()' returned 1:many mapping between keys and columns
```

```r
myAnnotation[1:3,]
```

```
##    SYMBOL  PATH
## 1  Mrpl15  &lt;NA&gt;
## 2 Atp6v1h 00190
## 3 Atp6v1h 01100
```

---
#KEGG

We can access more descriptive information on these PATH IDs from the **KEGG.db** package.


```r
library(KEGG.db)
pathOInterest &lt;- myAnnotation$PATH

KEGGAnnotation &lt;- select(KEGG.db, keys = pathOInterest, keytype = "PATH", 
                       columns = c("PATH", "NAME"))
annotationTable &lt;- merge(myAnnotation,KEGGAnnotation,by.x="PATH",by.y="PATH")
annotationTable[1:3,]
```


```
## 
## KEGG.db contains mappings based on older data because the original
##   resource was removed from the the public domain before the most
##   recent update was produced. This package should now be
##   considered deprecated and future versions of Bioconductor may
##   not have it available.  Users who want more current data are
##   encouraged to look at the KEGGREST or reactome.db packages
```

```
##    PATH  SYMBOL                      NAME
## 1 00190 Atp6v1h Oxidative phosphorylation
## 2 01100 Atp6v1h        Metabolic pathways
## 3 04142 Atp6v1h                  Lysosome
```

---
#KEGG

We could access PATHID to NAME information as a list.


```r
annoList &lt;- unlist(as.list(KEGGPATHID2NAME))
annoList
```

```
##                                                                             00010 
##                                                    "Glycolysis / Gluconeogenesis" 
##                                                                             00020 
##                                                       "Citrate cycle (TCA cycle)" 
##                                                                             00030 
##                                                       "Pentose phosphate pathway" 
##                                                                             00040 
##                                        "Pentose and glucuronate interconversions" 
##                                                                             00051 
##                                                 "Fructose and mannose metabolism" 
##                                                                             00052 
##                                                            "Galactose metabolism" 
##                                                                             00053 
##                                               "Ascorbate and aldarate metabolism" 
##                                                                             00061 
##                                                         "Fatty acid biosynthesis" 
##                                                                             00062 
##                                                           "Fatty acid elongation" 
##                                                                             00071 
##                                                          "Fatty acid degradation" 
##                                                                             00072 
##                                      "Synthesis and degradation of ketone bodies" 
##                                                                             00073 
##                                            "Cutin, suberine and wax biosynthesis" 
##                                                                             00100 
##                                                            "Steroid biosynthesis" 
##                                                                             00120 
##                                                  "Primary bile acid biosynthesis" 
##                                                                             00121 
##                                                "Secondary bile acid biosynthesis" 
##                                                                             00130 
##                             "Ubiquinone and other terpenoid-quinone biosynthesis" 
##                                                                             00140 
##                                                    "Steroid hormone biosynthesis" 
##                                                                             00190 
##                                                       "Oxidative phosphorylation" 
##                                                                             00195 
##                                                                  "Photosynthesis" 
##                                                                             00196 
##                                               "Photosynthesis - antenna proteins" 
##                                                                             00220 
##                                                           "Arginine biosynthesis" 
##                                                                             00230 
##                                                               "Purine metabolism" 
##                                                                             00231 
##                                                          "Puromycin biosynthesis" 
##                                                                             00232 
##                                                             "Caffeine metabolism" 
##                                                                             00240 
##                                                           "Pyrimidine metabolism" 
##                                                                             00250 
##                                     "Alanine, aspartate and glutamate metabolism" 
##                                                                             00253 
##                                                       "Tetracycline biosynthesis" 
##                                                                             00254 
##                                                          "Aflatoxin biosynthesis" 
##                                                                             00260 
##                                        "Glycine, serine and threonine metabolism" 
##                                                                             00261 
##                                                         "Monobactam biosynthesis" 
##                                                                             00270 
##                                              "Cysteine and methionine metabolism" 
##                                                                             00280 
##                                      "Valine, leucine and isoleucine degradation" 
##                                                                             00281 
##                                                            "Geraniol degradation" 
##                                                                             00290 
##                                     "Valine, leucine and isoleucine biosynthesis" 
##                                                                             00300 
##                                                             "Lysine biosynthesis" 
##                                                                             00310 
##                                                              "Lysine degradation" 
##                                                                             00311 
##                                       "Penicillin and cephalosporin biosynthesis" 
##                                                                             00330 
##                                                 "Arginine and proline metabolism" 
##                                                                             00331 
##                                                    "Clavulanic acid biosynthesis" 
##                                                                             00332 
##                                                         "Carbapenem biosynthesis" 
##                                                                             00340 
##                                                            "Histidine metabolism" 
##                                                                             00350 
##                                                             "Tyrosine metabolism" 
##                                                                             00351 
##                                                                 "DDT degradation" 
##                                                                             00360 
##                                                        "Phenylalanine metabolism" 
##                                                                             00361 
##                                 "Chlorocyclohexane and chlorobenzene degradation" 
##                                                                             00362 
##                                                            "Benzoate degradation" 
##                                                                             00363 
##                                                           "Bisphenol degradation" 
##                                                                             00364 
##                                                      "Fluorobenzoate degradation" 
##                                                                             00365 
##                                                            "Furfural degradation" 
##                                                                             00380 
##                                                           "Tryptophan metabolism" 
##                                                                             00400 
##                             "Phenylalanine, tyrosine and tryptophan biosynthesis" 
##                                                                             00401 
##                                                         "Novobiocin biosynthesis" 
##                                                                             00402 
##                                                      "Benzoxazinoid biosynthesis" 
##                                                                             00403 
##                                          "Indole diterpene alkaloid biosynthesis" 
##                                                                             00410 
##                                                         "beta-Alanine metabolism" 
##                                                                             00430 
##                                              "Taurine and hypotaurine metabolism" 
##                                                                             00440 
##                                          "Phosphonate and phosphinate metabolism" 
##                                                                             00450 
##                                                       "Selenocompound metabolism" 
##                                                                             00460 
##                                                      "Cyanoamino acid metabolism" 
##                                                                             00471 
##                                          "D-Glutamine and D-glutamate metabolism" 
##                                                                             00472 
##                                           "D-Arginine and D-ornithine metabolism" 
##                                                                             00473 
##                                                            "D-Alanine metabolism" 
##                                                                             00480 
##                                                          "Glutathione metabolism" 
##                                                                             00500 
##                                                   "Starch and sucrose metabolism" 
##                                                                             00510 
##                                                           "N-Glycan biosynthesis" 
##                                                                             00511 
##                                                        "Other glycan degradation" 
##                                                                             00512 
##                                                "Mucin type O-Glycan biosynthesis" 
##                                                                             00513 
##                                          "Various types of N-glycan biosynthesis" 
##                                                                             00514 
##                                            "Other types of O-glycan biosynthesis" 
##                                                                             00520 
##                                     "Amino sugar and nucleotide sugar metabolism" 
##                                                                             00521 
##                                                       "Streptomycin biosynthesis" 
##                                                                             00522 
##                             "Biosynthesis of 12-, 14- and 16-membered macrolides" 
##                                                                             00523 
##                                              "Polyketide sugar unit biosynthesis" 
##                                                                             00524 
##                                             "Butirosin and neomycin biosynthesis" 
##                                                                             00531 
##                                                   "Glycosaminoglycan degradation" 
##                                                                             00532 
##         "Glycosaminoglycan biosynthesis - chondroitin sulfate / dermatan sulfate" 
##                                                                             00533 
##                                "Glycosaminoglycan biosynthesis - keratan sulfate" 
##                                                                             00534 
##                      "Glycosaminoglycan biosynthesis - heparan sulfate / heparin" 
##                                                                             00540 
##                                                 "Lipopolysaccharide biosynthesis" 
##                                                                             00550 
##                                                      "Peptidoglycan biosynthesis" 
##                                                                             00561 
##                                                         "Glycerolipid metabolism" 
##                                                                             00562 
##                                                   "Inositol phosphate metabolism" 
##                                                                             00563 
##                           "Glycosylphosphatidylinositol(GPI)-anchor biosynthesis" 
##                                                                             00564 
##                                                  "Glycerophospholipid metabolism" 
##                                                                             00565 
##                                                          "Ether lipid metabolism" 
##                                                                             00590 
##                                                     "Arachidonic acid metabolism" 
##                                                                             00591 
##                                                        "Linoleic acid metabolism" 
##                                                                             00592 
##                                                 "alpha-Linolenic acid metabolism" 
##                                                                             00600 
##                                                         "Sphingolipid metabolism" 
##                                                                             00601 
##                      "Glycosphingolipid biosynthesis - lacto and neolacto series" 
##                                                                             00603 
##                                   "Glycosphingolipid biosynthesis - globo series" 
##                                                                             00604 
##                                 "Glycosphingolipid biosynthesis - ganglio series" 
##                                                                             00620 
##                                                             "Pyruvate metabolism" 
##                                                                             00621 
##                                                              "Dioxin degradation" 
##                                                                             00622 
##                                                              "Xylene degradation" 
##                                                                             00623 
##                                                             "Toluene degradation" 
##                                                                             00624 
##                                     "Polycyclic aromatic hydrocarbon degradation" 
##                                                                             00625 
##                                       "Chloroalkane and chloroalkene degradation" 
##                                                                             00626 
##                                                         "Naphthalene degradation" 
##                                                                             00627 
##                                                       "Aminobenzoate degradation" 
##                                                                             00630 
##                                         "Glyoxylate and dicarboxylate metabolism" 
##                                                                             00633 
##                                                        "Nitrotoluene degradation" 
##                                                                             00640 
##                                                           "Propanoate metabolism" 
##                                                                             00642 
##                                                        "Ethylbenzene degradation" 
##                                                                             00643 
##                                                             "Styrene degradation" 
##                                                                             00650 
##                                                            "Butanoate metabolism" 
##                                                                             00660 
##                                             "C5-Branched dibasic acid metabolism" 
##                                                                             00670 
##                                                       "One carbon pool by folate" 
##                                                                             00680 
##                                                              "Methane metabolism" 
##                                                                             00710 
##                                     "Carbon fixation in photosynthetic organisms" 
##                                                                             00720 
##                                         "Carbon fixation pathways in prokaryotes" 
##                                                                             00730 
##                                                             "Thiamine metabolism" 
##                                                                             00740 
##                                                           "Riboflavin metabolism" 
##                                                                             00750 
##                                                           "Vitamin B6 metabolism" 
##                                                                             00760 
##                                          "Nicotinate and nicotinamide metabolism" 
##                                                                             00770 
##                                               "Pantothenate and CoA biosynthesis" 
##                                                                             00780 
##                                                               "Biotin metabolism" 
##                                                                             00785 
##                                                          "Lipoic acid metabolism" 
##                                                                             00790 
##                                                             "Folate biosynthesis" 
##                                                                             00791 
##                                                            "Atrazine degradation" 
##                                                                             00830 
##                                                              "Retinol metabolism" 
##                                                                             00860 
##                                            "Porphyrin and chlorophyll metabolism" 
##                                                                             00900 
##                                                 "Terpenoid backbone biosynthesis" 
##                                                                             00901 
##                                                    "Indole alkaloid biosynthesis" 
##                                                                             00902 
##                                                      "Monoterpenoid biosynthesis" 
##                                                                             00903 
##                                                 "Limonene and pinene degradation" 
##                                                                             00904 
##                                                        "Diterpenoid biosynthesis" 
##                                                                             00905 
##                                                    "Brassinosteroid biosynthesis" 
##                                                                             00906 
##                                                         "Carotenoid biosynthesis" 
##                                                                             00908 
##                                                             "Zeatin biosynthesis" 
##                                                                             00909 
##                                   "Sesquiterpenoid and triterpenoid biosynthesis" 
##                                                                             00910 
##                                                             "Nitrogen metabolism" 
##                                                                             00920 
##                                                               "Sulfur metabolism" 
##                                                                             00930 
##                                                         "Caprolactam degradation" 
##                                                                             00940 
##                                                    "Phenylpropanoid biosynthesis" 
##                                                                             00941 
##                                                          "Flavonoid biosynthesis" 
##                                                                             00942 
##                                                        "Anthocyanin biosynthesis" 
##                                                                             00943 
##                                                       "Isoflavonoid biosynthesis" 
##                                                                             00944 
##                                               "Flavone and flavonol biosynthesis" 
##                                                                             00945 
##                           "Stilbenoid, diarylheptanoid and gingerol biosynthesis" 
##                                                                             00950 
##                                              "Isoquinoline alkaloid biosynthesis" 
##                                                                             00960 
##                          "Tropane, piperidine and pyridine alkaloid biosynthesis" 
##                                                                             00965 
##                                                           "Betalain biosynthesis" 
##                                                                             00966 
##                                                      "Glucosinolate biosynthesis" 
##                                                                             00970 
##                                                     "Aminoacyl-tRNA biosynthesis" 
##                                                                             00980 
##                                    "Metabolism of xenobiotics by cytochrome P450" 
##                                                                             00981 
##                                                     "Insect hormone biosynthesis" 
##                                                                             00982 
##                                               "Drug metabolism - cytochrome P450" 
##                                                                             00983 
##                                                 "Drug metabolism - other enzymes" 
##                                                                             00984 
##                                                             "Steroid degradation" 
##                                                                             01010 
##                                               "Overview of biosynthetic pathways" 
##                                                                             01040 
##                                         "Biosynthesis of unsaturated fatty acids" 
##                                                                             01051 
##                                                      "Biosynthesis of ansamycins" 
##                                                                             01052 
##                                                    "Type I polyketide structures" 
##                                                                             01053 
##                         "Biosynthesis of siderophore group nonribosomal peptides" 
##                                                                             01054 
##                                                 "Nonribosomal peptide structures" 
##                                                                             01055 
##                                    "Biosynthesis of vancomycin group antibiotics" 
##                                                                             01056 
##                                     "Biosynthesis of type II polyketide backbone" 
##                                                                             01057 
##                                     "Biosynthesis of type II polyketide products" 
##                                                                             01058 
##                                                  "Acridone alkaloid biosynthesis" 
##                                                                             01060 
##                                     "Biosynthesis of plant secondary metabolites" 
##                                                                             01061 
##                                                "Biosynthesis of phenylpropanoids" 
##                                                                             01062 
##                                         "Biosynthesis of terpenoids and steroids" 
##                                                                             01063 
##                        "Biosynthesis of alkaloids derived from shikimate pathway" 
##                                                                             01064 
##     "Biosynthesis of alkaloids derived from ornithine, lysine and nicotinic acid" 
##                                                                             01065 
##                     "Biosynthesis of alkaloids derived from histidine and purine" 
##                                                                             01066 
##                 "Biosynthesis of alkaloids derived from terpenoid and polyketide" 
##                                                                             01070 
##                                                  "Biosynthesis of plant hormones" 
##                                                                             01100 
##                                                              "Metabolic pathways" 
##                                                                             01110 
##                                           "Biosynthesis of secondary metabolites" 
##                                                                             01120 
##                                    "Microbial metabolism in diverse environments" 
##                                                                             01130 
##                                                     "Biosynthesis of antibiotics" 
##                                                                             01200 
##                                                               "Carbon metabolism" 
##                                                                             01210 
##                                                 "2-Oxocarboxylic acid metabolism" 
##                                                                             01212 
##                                                           "Fatty acid metabolism" 
##                                                                             01220 
##                                               "Degradation of aromatic compounds" 
##                                                                             01230 
##                                                     "Biosynthesis of amino acids" 
##                                                                             01501 
##                                                          "beta-Lactam resistance" 
##                                                                             01502 
##                                                           "Vancomycin resistance" 
##                                                                             01503 
##                                "Cationic antimicrobial peptide (CAMP) resistance" 
##                                                                             02010 
##                                                                "ABC transporters" 
##                                                                             02020 
##                                                            "Two-component system" 
##                                                                             02030 
##                                                            "Bacterial chemotaxis" 
##                                                                             02040 
##                                                              "Flagellar assembly" 
##                                                                             02060 
##                                                 "Phosphotransferase system (PTS)" 
##                                                                             03008 
##                                               "Ribosome biogenesis in eukaryotes" 
##                                                                             03010 
##                                                                        "Ribosome" 
##                                                                             03013 
##                                                                   "RNA transport" 
##                                                                             03015 
##                                                       "mRNA surveillance pathway" 
##                                                                             03018 
##                                                                 "RNA degradation" 
##                                                                             03020 
##                                                                  "RNA polymerase" 
##                                                                             03022 
##                                                     "Basal transcription factors" 
##                                                                             03030 
##                                                                 "DNA replication" 
##                                                                             03040 
##                                                                     "Spliceosome" 
##                                                                             03050 
##                                                                      "Proteasome" 
##                                                                             03060 
##                                                                  "Protein export" 
##                                                                             03070 
##                                                      "Bacterial secretion system" 
##                                                                             03320 
##                                                          "PPAR signaling pathway" 
##                                                                             03410 
##                                                            "Base excision repair" 
##                                                                             03420 
##                                                      "Nucleotide excision repair" 
##                                                                             03430 
##                                                                 "Mismatch repair" 
##                                                                             03440 
##                                                        "Homologous recombination" 
##                                                                             03450 
##                                                      "Non-homologous end-joining" 
##                                                                             03460 
##                                                          "Fanconi anemia pathway" 
##                                                                             04010 
##                                                          "MAPK signaling pathway" 
##                                                                             04011 
##                                                  "MAPK signaling pathway - yeast" 
##                                                                             04012 
##                                                          "ErbB signaling pathway" 
##                                                                             04013 
##                                                    "MAPK signaling pathway - fly" 
##                                                                             04014 
##                                                           "Ras signaling pathway" 
##                                                                             04015 
##                                                          "Rap1 signaling pathway" 
##                                                                             04020 
##                                                       "Calcium signaling pathway" 
##                                                                             04022 
##                                                      "cGMP-PKG signaling pathway" 
##                                                                             04024 
##                                                          "cAMP signaling pathway" 
##                                                                             04060 
##                                          "Cytokine-cytokine receptor interaction" 
##                                                                             04062 
##                                                     "Chemokine signaling pathway" 
##                                                                             04064 
##                                                    "NF-kappa B signaling pathway" 
##                                                                             04066 
##                                                         "HIF-1 signaling pathway" 
##                                                                             04068 
##                                                          "FoxO signaling pathway" 
##                                                                             04070 
##                                           "Phosphatidylinositol signaling system" 
##                                                                             04071 
##                                                  "Sphingolipid signaling pathway" 
##                                                                             04075 
##                                               "Plant hormone signal transduction" 
##                                                                             04080 
##                                         "Neuroactive ligand-receptor interaction" 
##                                                                             04110 
##                                                                      "Cell cycle" 
##                                                                             04111 
##                                                              "Cell cycle - yeast" 
##                                                                             04112 
##                                                        "Cell cycle - Caulobacter" 
##                                                                             04113 
##                                                                 "Meiosis - yeast" 
##                                                                             04114 
##                                                                  "Oocyte meiosis" 
##                                                                             04115 
##                                                           "p53 signaling pathway" 
##                                                                             04120 
##                                                  "Ubiquitin mediated proteolysis" 
##                                                                             04122 
##                                                             "Sulfur relay system" 
##                                                                             04130 
##                                       "SNARE interactions in vesicular transport" 
##                                                                             04140 
##                                                         "Regulation of autophagy" 
##                                                                             04141 
##                                     "Protein processing in endoplasmic reticulum" 
##                                                                             04142 
##                                                                        "Lysosome" 
##                                                                             04144 
##                                                                     "Endocytosis" 
##                                                                             04145 
##                                                                       "Phagosome" 
##                                                                             04146 
##                                                                      "Peroxisome" 
##                                                                             04150 
##                                                          "mTOR signaling pathway" 
##                                                                             04151 
##                                                      "PI3K-Akt signaling pathway" 
##                                                                             04152 
##                                                          "AMPK signaling pathway" 
##                                                                             04210 
##                                                                       "Apoptosis" 
##                                                                             04260 
##                                                      "Cardiac muscle contraction" 
##                                                                             04261 
##                                          "Adrenergic signaling in cardiomyocytes" 
##                                                                             04270 
##                                              "Vascular smooth muscle contraction" 
##                                                                             04310 
##                                                           "Wnt signaling pathway" 
##                                                                             04320 
##                                                    "Dorso-ventral axis formation" 
##                                                                             04330 
##                                                         "Notch signaling pathway" 
##                                                                             04340 
##                                                      "Hedgehog signaling pathway" 
##                                                                             04350 
##                                                      "TGF-beta signaling pathway" 
##                                                                             04360 
##                                                                   "Axon guidance" 
##                                                                             04370 
##                                                          "VEGF signaling pathway" 
##                                                                             04380 
##                                                      "Osteoclast differentiation" 
##                                                                             04390 
##                                                         "Hippo signaling pathway" 
##                                                                             04391 
##                                                   "Hippo signaling pathway - fly" 
##                                                                             04510 
##                                                                  "Focal adhesion" 
##                                                                             04512 
##                                                        "ECM-receptor interaction" 
##                                                                             04514 
##                                                  "Cell adhesion molecules (CAMs)" 
##                                                                             04520 
##                                                               "Adherens junction" 
##                                                                             04530 
##                                                                  "Tight junction" 
##                                                                             04540 
##                                                                    "Gap junction" 
##                                                                             04550 
##                        "Signaling pathways regulating pluripotency of stem cells" 
##                                                                             04610 
##                                             "Complement and coagulation cascades" 
##                                                                             04611 
##                                                             "Platelet activation" 
##                                                                             04612 
##                                             "Antigen processing and presentation" 
##                                                                             04614 
##                                                        "Renin-angiotensin system" 
##                                                                             04620 
##                                            "Toll-like receptor signaling pathway" 
##                                                                             04621 
##                                             "NOD-like receptor signaling pathway" 
##                                                                             04622 
##                                           "RIG-I-like receptor signaling pathway" 
##                                                                             04623 
##                                                   "Cytosolic DNA-sensing pathway" 
##                                                                             04626 
##                                                      "Plant-pathogen interaction" 
##                                                                             04630 
##                                                      "Jak-STAT signaling pathway" 
##                                                                             04640 
##                                                      "Hematopoietic cell lineage" 
##                                                                             04650 
##                                       "Natural killer cell mediated cytotoxicity" 
##                                                                             04660 
##                                               "T cell receptor signaling pathway" 
##                                                                             04662 
##                                               "B cell receptor signaling pathway" 
##                                                                             04664 
##                                                 "Fc epsilon RI signaling pathway" 
##                                                                             04666 
##                                                "Fc gamma R-mediated phagocytosis" 
##                                                                             04668 
##                                                           "TNF signaling pathway" 
##                                                                             04670 
##                                            "Leukocyte transendothelial migration" 
##                                                                             04672 
##                                    "Intestinal immune network for IgA production" 
##                                                                             04710 
##                                                                "Circadian rhythm" 
##                                                                             04711 
##                                                          "Circadian rhythm - fly" 
##                                                                             04712 
##                                                        "Circadian rhythm - plant" 
##                                                                             04713 
##                                                           "Circadian entrainment" 
##                                                                             04720 
##                                                          "Long-term potentiation" 
##                                                                             04721 
##                                                          "Synaptic vesicle cycle" 
##                                                                             04722 
##                                                  "Neurotrophin signaling pathway" 
##                                                                             04723 
##                                            "Retrograde endocannabinoid signaling" 
##                                                                             04724 
##                                                           "Glutamatergic synapse" 
##                                                                             04725 
##                                                             "Cholinergic synapse" 
##                                                                             04726 
##                                                            "Serotonergic synapse" 
##                                                                             04727 
##                                                               "GABAergic synapse" 
##                                                                             04728 
##                                                            "Dopaminergic synapse" 
##                                                                             04730 
##                                                            "Long-term depression" 
##                                                                             04740 
##                                                          "Olfactory transduction" 
##                                                                             04742 
##                                                              "Taste transduction" 
##                                                                             04744 
##                                                               "Phototransduction" 
##                                                                             04745 
##                                                         "Phototransduction - fly" 
##                                                                             04750 
##                                "Inflammatory mediator regulation of TRP channels" 
##                                                                             04810 
##                                                "Regulation of actin cytoskeleton" 
##                                                                             04910 
##                                                       "Insulin signaling pathway" 
##                                                                             04911 
##                                                               "Insulin secretion" 
##                                                                             04912 
##                                                          "GnRH signaling pathway" 
##                                                                             04913 
##                                                         "Ovarian steroidogenesis" 
##                                                                             04914 
##                                         "Progesterone-mediated oocyte maturation" 
##                                                                             04915 
##                                                      "Estrogen signaling pathway" 
##                                                                             04916 
##                                                                   "Melanogenesis" 
##                                                                             04917 
##                                                     "Prolactin signaling pathway" 
##                                                                             04918 
##                                                       "Thyroid hormone synthesis" 
##                                                                             04919 
##                                               "Thyroid hormone signaling pathway" 
##                                                                             04920 
##                                                 "Adipocytokine signaling pathway" 
##                                                                             04921 
##                                                      "Oxytocin signaling pathway" 
##                                                                             04922 
##                                                      "Glucagon signaling pathway" 
##                                                                             04923 
##                                           "Regulation of lipolysis in adipocytes" 
##                                                                             04924 
##                                                                 "Renin secretion" 
##                                                                             04925 
##                                             "Aldosterone synthesis and secretion" 
##                                                                             04930 
##                                                       "Type II diabetes mellitus" 
##                                                                             04931 
##                                                              "Insulin resistance" 
##                                                                             04932 
##                                       "Non-alcoholic fatty liver disease (NAFLD)" 
##                                                                             04940 
##                                                        "Type I diabetes mellitus" 
##                                                                             04950 
##                                            "Maturity onset diabetes of the young" 
##                                                                             04960 
##                                       "Aldosterone-regulated sodium reabsorption" 
##                                                                             04961 
##                       "Endocrine and other factor-regulated calcium reabsorption" 
##                                                                             04962 
##                                        "Vasopressin-regulated water reabsorption" 
##                                                                             04964 
##                                         "Proximal tubule bicarbonate reclamation" 
##                                                                             04966 
##                                                  "Collecting duct acid secretion" 
##                                                                             04970 
##                                                              "Salivary secretion" 
##                                                                             04971 
##                                                          "Gastric acid secretion" 
##                                                                             04972 
##                                                            "Pancreatic secretion" 
##                                                                             04973 
##                                           "Carbohydrate digestion and absorption" 
##                                                                             04974 
##                                                "Protein digestion and absorption" 
##                                                                             04975 
##                                                    "Fat digestion and absorption" 
##                                                                             04976 
##                                                                  "Bile secretion" 
##                                                                             04977 
##                                                "Vitamin digestion and absorption" 
##                                                                             04978 
##                                                              "Mineral absorption" 
##                                                                             05010 
##                                                             "Alzheimer's disease" 
##                                                                             05012 
##                                                             "Parkinson's disease" 
##                                                                             05014 
##                                             "Amyotrophic lateral sclerosis (ALS)" 
##                                                                             05016 
##                                                            "Huntington's disease" 
##                                                                             05020 
##                                                                  "Prion diseases" 
##                                                                             05030 
##                                                               "Cocaine addiction" 
##                                                                             05031 
##                                                           "Amphetamine addiction" 
##                                                                             05032 
##                                                              "Morphine addiction" 
##                                                                             05033 
##                                                              "Nicotine addiction" 
##                                                                             05034 
##                                                                      "Alcoholism" 
##                                                                             05100 
##                                          "Bacterial invasion of epithelial cells" 
##                                                                             05110 
##                                                       "Vibrio cholerae infection" 
##                                                                             05111 
##                                                "Vibrio cholerae pathogenic cycle" 
##                                                                             05120 
##                      "Epithelial cell signaling in Helicobacter pylori infection" 
##                                                                             05130 
##                                           "Pathogenic Escherichia coli infection" 
##                                                                             05131 
##                                                                     "Shigellosis" 
##                                                                             05132 
##                                                            "Salmonella infection" 
##                                                                             05133 
##                                                                       "Pertussis" 
##                                                                             05134 
##                                                                   "Legionellosis" 
##                                                                             05140 
##                                                                   "Leishmaniasis" 
##                                                                             05142 
##                                       "Chagas disease (American trypanosomiasis)" 
##                                                                             05143 
##                                                         "African trypanosomiasis" 
##                                                                             05144 
##                                                                         "Malaria" 
##                                                                             05145 
##                                                                   "Toxoplasmosis" 
##                                                                             05146 
##                                                                      "Amoebiasis" 
##                                                                             05150 
##                                                 "Staphylococcus aureus infection" 
##                                                                             05152 
##                                                                    "Tuberculosis" 
##                                                                             05160 
##                                                                     "Hepatitis C" 
##                                                                             05161 
##                                                                     "Hepatitis B" 
##                                                                             05162 
##                                                                         "Measles" 
##                                                                             05164 
##                                                                     "Influenza A" 
##                                                                             05166 
##                                                                "HTLV-I infection" 
##                                                                             05168 
##                                                        "Herpes simplex infection" 
##                                                                             05169 
##                                                    "Epstein-Barr virus infection" 
##                                                                             05200 
##                                                              "Pathways in cancer" 
##                                                                             05202 
##                                         "Transcriptional misregulation in cancer" 
##                                                                             05203 
##                                                            "Viral carcinogenesis" 
##                                                                             05204 
##                                                         "Chemical carcinogenesis" 
##                                                                             05205 
##                                                         "Proteoglycans in cancer" 
##                                                                             05206 
##                                                             "MicroRNAs in cancer" 
##                                                                             05210 
##                                                               "Colorectal cancer" 
##                                                                             05211 
##                                                            "Renal cell carcinoma" 
##                                                                             05212 
##                                                               "Pancreatic cancer" 
##                                                                             05213 
##                                                              "Endometrial cancer" 
##                                                                             05214 
##                                                                          "Glioma" 
##                                                                             05215 
##                                                                 "Prostate cancer" 
##                                                                             05216 
##                                                                  "Thyroid cancer" 
##                                                                             05217 
##                                                            "Basal cell carcinoma" 
##                                                                             05218 
##                                                                        "Melanoma" 
##                                                                             05219 
##                                                                  "Bladder cancer" 
##                                                                             05220 
##                                                        "Chronic myeloid leukemia" 
##                                                                             05221 
##                                                          "Acute myeloid leukemia" 
##                                                                             05222 
##                                                          "Small cell lung cancer" 
##                                                                             05223 
##                                                      "Non-small cell lung cancer" 
##                                                                             05230 
##                                             "Central carbon metabolism in cancer" 
##                                                                             05231 
##                                                    "Choline metabolism in cancer" 
##                                                                             05310 
##                                                                          "Asthma" 
##                                                                             05320 
##                                                      "Autoimmune thyroid disease" 
##                                                                             05321 
##                                                "Inflammatory bowel disease (IBD)" 
##                                                                             05322 
##                                                    "Systemic lupus erythematosus" 
##                                                                             05323 
##                                                            "Rheumatoid arthritis" 
##                                                                             05330 
##                                                             "Allograft rejection" 
##                                                                             05332 
##                                                       "Graft-versus-host disease" 
##                                                                             05340 
##                                                        "Primary immunodeficiency" 
##                                                                             05410 
##                                               "Hypertrophic cardiomyopathy (HCM)" 
##                                                                             05412 
##                          "Arrhythmogenic right ventricular cardiomyopathy (ARVC)" 
##                                                                             05414 
##                                                          "Dilated cardiomyopathy" 
##                                                                             05416 
##                                                               "Viral myocarditis" 
##                                                                             07011 
##                                                                     "Penicillins" 
##                                                                             07012 
##                                              "Cephalosporins - parenteral agents" 
##                                                                             07013 
##                                                    "Cephalosporins - oral agents" 
##                                                                             07014 
##                                                                      "Quinolones" 
##                                                                             07015 
##                                                                "Local analgesics" 
##                                                                             07016 
##                                           "Sulfonamide derivatives - sulfa drugs" 
##                                                                             07017 
##                                             "Sulfonamide derivatives - diuretics" 
##                                                                             07018 
##                                   "Sulfonamide derivatives - hypoglycemic agents" 
##                                                                             07019 
##                                                                   "Tetracyclines" 
##                                                                             07020 
##                                                        "Macrolides and ketolides" 
##                                                                             07021 
##                                                                 "Aminoglycosides" 
##                                                                             07023 
##                                                                      "Rifamycins" 
##                                                                             07024 
##                                                    "HMG-CoA reductase inhibitors" 
##                                                                             07025 
##                                                                      "Quinolines" 
##                                                                             07026 
##                                                               "Antifungal agents" 
##                                                                             07027 
##                                                                 "Antidepressants" 
##                                                                             07028 
##                                                                  "Antipsychotics" 
##                                                                             07029 
##                                                                  "Phenothiazines" 
##                                                                             07030 
##                                                                     "Anxiolytics" 
##                                                                             07031 
##                                                                  "Butyrophenones" 
##                                                                             07032 
##                                                                       "Hypnotics" 
##                                                                             07033 
##                                                                 "Anticonvulsants" 
##                                                                             07034 
##                                                                     "Eicosanoids" 
##                                                                             07035 
##                                                                  "Prostaglandins" 
##                                                                             07036 
##                                                  "Calcium channel blocking drugs" 
##                                                                             07037 
##                                                            "Antiarrhythmic drugs" 
##                                                                             07038 
##                                                                 "Antiulcer drugs" 
##                                                                             07039 
##                                                               "Opioid analgesics" 
##                                                                             07040 
##                                             "Antineoplastics - alkylating agents" 
##                                                                             07041 
##                                          "Antineoplastics - antimetabolic agents" 
##                                                                             07042 
##                                  "Antineoplastics - agents from natural products" 
##                                                                             07043 
##                                                      "Antineoplastics - hormones" 
##                                                                             07044 
##                                                                "Antiviral agents" 
##                                                                             07045 
##                                    "Antineoplastics - protein kinases inhibitors" 
##                                                                             07046 
##                                                        "Immunosuppressive agents" 
##                                                                             07047 
##                                                              "Osteoporosis drugs" 
##                                                                             07048 
##                                                                   "Antimigraines" 
##                                                                             07049 
##                                                           "Antithrombosis agents" 
##                                                                             07050 
##                                   "Antirheumatics - DMARDs and biological agents" 
##                                                                             07051 
##                                                                   "Antidiabetics" 
##                                                                             07052 
##                                                         "Antidyslipidemic agents" 
##                                                                             07053 
##                                                                 "Anti-HIV agents" 
##                                                                             07054 
##                                                             "Antiglaucoma agents" 
##                                                                             07055 
##                                              "Sulfonamide derivatives - overview" 
##                                                                             07056 
##                                              "Agents for Alzheimer-type dementia" 
##                                                                             07057 
##                                                         "Antiparkinsonian agents" 
##                                                                             07110 
##                                                             "Benzoic acid family" 
##                                                                             07112 
##                                                "1,2-Diphenyl substitution family" 
##                                                                             07114 
##                                                              "Naphthalene family" 
##                                                                             07117 
##                                                           "Benzodiazepine family" 
##                                                                             07211 
##                                         "Serotonin receptor agonists/antagonists" 
##                                                                             07212 
##                                               "Histamine H1 receptor antagonists" 
##                                                                             07213 
##                                          "Dopamine receptor agonists/antagonists" 
##                                                                             07214 
##                                   "beta-Adrenergic receptor agonists/antagonists" 
##                                                                             07215 
##                                  "alpha-Adrenergic receptor agonists/antagonists" 
##                                                                             07216 
##                                            "Catecholamine transferase inhibitors" 
##                                                                             07217 
##                                             "Renin-angiotensin system inhibitors" 
##                                                                             07218 
##                                                         "HIV protease inhibitors" 
##                                                                             07219 
##                                                       "Cyclooxygenase inhibitors" 
##                                                                             07220 
##                                           "Cholinergic and anticholinergic drugs" 
##                                                                             07221 
##                                      "Nicotinic cholinergic receptor antagonists" 
##                                                                             07222 
##                      "Peroxisome proliferator-activated receptor (PPAR) agonists" 
##                                                                             07223 
## "Retinoic acid receptor (RAR) and retinoid X receptor (RXR) agonists/antagonists" 
##                                                                             07224 
##                                            "Opioid receptor agonists/antagonists" 
##                                                                             07225 
##              "Glucocorticoid and meneralocorticoid receptor agonists/antagonists" 
##                                                                             07226 
##               "Progesterone, androgen and estrogen receptor agonists/antagonists" 
##                                                                             07227 
##                                   "Histamine H2/H3 receptor agonists/antagonists" 
##                                                                             07228 
##                                        "Eicosanoid receptor agonists/antagonists" 
##                                                                             07229 
##                        "Angiotensin receptor and endothelin receptor antagonists" 
##                                                                             07230 
##                                            "GABA-A receptor agonists/antagonists" 
##                                                                             07231 
##                                                   "Sodium channel blocking drugs" 
##                                                                             07232 
##                                    "Potassium channel blocking and opening drugs" 
##                                                                             07233 
##                                                      "Ion transporter inhibitors" 
##                                                                             07234 
##                                         "Neurotransmitter transporter inhibitors" 
##                                                                             07235 
##                                    "N-Metyl-D-aspartic acid receptor antagonists"
```

---
#KEGG

We could build our data.frame of annotation from this list as an alternative to using **select()** function.


```r
KEGGAnnotation &lt;- data.frame(PATH=names(annoList),NAME=unname(annoList))
annotationTable &lt;- merge(myAnnotation,KEGGAnnotation,by.x="PATH",by.y="PATH")
annotationTable[1:3,]
```

```
##    PATH  SYMBOL                      NAME
## 1 00190 Atp6v1h Oxidative phosphorylation
## 2 01100 Atp6v1h        Metabolic pathways
## 3 04142 Atp6v1h                  Lysosome
```





---
#MsigDB.
.pull-left[
The [molecular signatures database (MsigDB)](http://software.broadinstitute.org/gsea/msigdb/) is available from the Broad institute and provides a set of curated gene sets derived from sources such as GO, pathway databases, motif scans and even other experimental sets.

MsigDB databases are widely used in gene set enrichments analysis and are available as plain text in formats used with the popular Java based gene set enrichment software GSEA.
]
.pull-right[
&lt;div align="center"&gt;
&lt;img src="imgs/msigdb.png" alt="offset" height="500" width="350"&gt;
&lt;/div&gt;
]


---
# Genesets in Bioconductor..

In R we can access information on these gene sets through the **GSEABase** package. 

We will revisit this during RNA-seq practical.



```r
library(GSEABase)
myGeneSet &lt;- getGmt("c2.all.v4.symbols.gmt")
```

---
# Gene ontology and geneset testing for ChIPseq

Geneset enrichment testing may be performed on the sets of genes with peaks associated to them. In this example we will consider genes with peaks within 1000bp of a gene's TSS.

We will not access these database libraries directly in testing but will use other R/Bioconductor libraries which make extensive use of them.


&lt;div align="center"&gt;
&lt;img src="imgs/TSSPeak.png" alt="offset" height="250" width="600"&gt;
&lt;/div&gt;

---
# Gene ontology and geneset testing.


To perform geneset testing here, we will use the **GOseq package**.

We must provide a named numeric vector of 1s or 0s to illustrate whether a gene had any peaks overlapping it's TSS.

In this example we use all TSS sites we found to be overlapped by Myc peaks.

The peaks landing in TSS regions will be marked as "Promoter" in the **annotation** column of our annotated GRanges object. 


```r
annotatedPeaksGR[1,]
```

```
## GRanges object with 1 range and 14 metadata columns:
##       seqnames             ranges strand | abs_summit fold_enrichment
##          &lt;Rle&gt;          &lt;IRanges&gt;  &lt;Rle&gt; |  &lt;integer&gt;       &lt;numeric&gt;
##   [1]     chr1 [4785370, 4785641]      * |    4785565         5.23296
##        annotation   geneChr geneStart   geneEnd geneLength geneStrand
##       &lt;character&gt; &lt;integer&gt; &lt;integer&gt; &lt;integer&gt;  &lt;integer&gt;  &lt;integer&gt;
##   [1]    Promoter         1   4773200   4785726      12527          2
##            geneId transcriptId distanceToTSS            ENSEMBL
##       &lt;character&gt;  &lt;character&gt;     &lt;numeric&gt;        &lt;character&gt;
##   [1]       27395   uc007afd.3            85 ENSMUSG00000033845
##            SYMBOL                            GENENAME
##       &lt;character&gt;                         &lt;character&gt;
##   [1]      Mrpl15 mitochondrial ribosomal protein L15
##   -------
##   seqinfo: 21 sequences from mm10 genome
```
---
# Gene ontology and geneset testing.


We can extract the unique names of genes with peaks in their TSS by subsetting the annotated GRanges and retrieving gene names from the **geneId** column.


```r
annotatedPeaksGR_TSS &lt;- annotatedPeaksGR[
  annotatedPeaksGR$annotation == "Promoter",]
genesWithPeakInTSS &lt;- unique(annotatedPeaksGR_TSS$geneId)
genesWithPeakInTSS[1:2]
```

```
## [1] "27395"  "108664"
```

---
# Gene ontology and functional testing.


Next we can extract all genes which are included in the TxDb object to use as our universe of genes for pathway enrichment.



```r
allGeneGR &lt;- genes(TxDb.Mmusculus.UCSC.mm10.knownGene)
allGeneGR[1:3, ]
```

```
## GRanges object with 3 ranges and 1 metadata column:
##             seqnames               ranges strand |     gene_id
##                &lt;Rle&gt;            &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt;
##   100009600     chr9 [21062393, 21075496]      - |   100009600
##   100009609     chr7 [84940169, 84964009]      - |   100009609
##   100009614    chr10 [77711446, 77712009]      + |   100009614
##   -------
##   seqinfo: 66 sequences (1 circular) from mm10 genome
```

```r
allGeneIDs &lt;- allGeneGR$gene_id
```

---
# Gene ontology and functional testing.


Once we have a vector of all genes we can create a named vector of 1s or 0s representing whether a gene had peak in TSS or not. 
We can turn a logical vector into 1 for TRUE and 0 for FALSE simply using the **as.integer()** function.


```r
allGenesForGOseq &lt;- as.integer(allGeneIDs %in% genesWithPeakInTSS)
names(allGenesForGOseq) &lt;- allGeneIDs
allGenesForGOseq[1:3]
```

```
## 100009600 100009609 100009614 
##         0         0         0
```


---

# Gene ontology and functional testing.

Now we have the the input for GOseq we can test against KEGG (or GO if we choose) using a standard hypergeometric test.

First we must construct a **nullp** data.frame for use within **goseq** using the **nullp()** function and supplying our named vector, genome to be used and gene identifier used.

The **nullp()** function attempts to correct for gene length biases we may see in geneset testing. i.e. a longer gene may have more chance to have a peak within it.





```r
library(goseq)
pwf = nullp(allGenesForGOseq, "mm10", "knownGene", plot.fit = FALSE)
```

```
## Can't find mm10/knownGene length data in genLenDataBase...
```

```
## Found the annotaion package, TxDb.Mmusculus.UCSC.mm10.knownGene
```

```
## Trying to get the gene lengths from it.
```

---

# Gene ontology and functional testing.

We can see which genomes are supported using the **supportedGenomes()** function.


```r
supGenomes &lt;- supportedGenomes()
supGenomes[1:2, ]
```

```
##     db species      date                               name
## 2 hg19   Human Feb. 2009 Genome Reference Consortium GRCh37
## 3 hg18   Human Mar. 2006                    NCBI Build 36.1
##                                                                                                                  AvailableGeneIDs
## 2                                                    ccdsGene,ensGene,exoniphy,geneSymbol,knownGene,nscanGene,refGene,xenoRefGene
## 3 acembly,acescan,ccdsGene,ensGene,exoniphy,geneSymbol,geneid,genscan,knownGene,knownGeneOld3,refGene,sgpGene,sibGene,xenoRefGene
```

---

# Gene ontology and functional testing.

Now we have created our nullp data.frame, we can use this within the **goseq()** function to test for the enrichment of genesets.

We also select a database of genesets to test, here "KEGG". We can choose additionally from "GO:CC", "GO:BP", "GO:MF" genesets.

As we are testing peaks in 1000bp windows around genes's TSSs we can simply use the **"Hypergeometric"** for the method parameter.


```r
Kegg_MycPeaks &lt;- goseq(pwf,"mm10","knownGene",
                       test.cats=c("KEGG"),
                       method="Hypergeometric")

Kegg_MycPeaks[1:2,]
```




```
##    category over_represented_pvalue under_represented_pvalue numDEInCat
## 89    03010            2.456015e-35                        1         76
## 90    03013            4.820887e-32                        1        108
##    numInCat
## 89       87
## 90      157
```
---
# Gene ontology and functional testing.

The dataframe of enrichment results contains KEGG IDs but no description of pathways and processes.

We can use the **KEGG.db** package to extract a mapping of IDs to descriptive statistics.



```r
library(KEGG.db)
xx &lt;- as.list(KEGGPATHID2NAME)
idtoName &lt;- cbind(names(xx),unlist(xx))
idtoName[1:5,]
```

```
##       [,1]    [,2]                                      
## 00010 "00010" "Glycolysis / Gluconeogenesis"            
## 00020 "00020" "Citrate cycle (TCA cycle)"               
## 00030 "00030" "Pentose phosphate pathway"               
## 00040 "00040" "Pentose and glucuronate interconversions"
## 00051 "00051" "Fructose and mannose metabolism"
```
---
# Gene ontology and functional testing.

We can now merge our data.frame of ID to pathway name mappings to our data.frame of enrichment results.


```r
KeggN_MycPeaks &lt;- merge(idtoName,Kegg_MycPeaks,by=1,all=TRUE)
orderByP &lt;- order(KeggN_MycPeaks$over_represented_pvalue)
KeggN_MycPeaks &lt;- KeggN_MycPeaks[orderByP,]
KeggN_MycPeaks[1:5,]
```

```
##        V1                                V2 over_represented_pvalue
## 187 03010                          Ribosome            2.456015e-35
## 188 03013                     RNA transport            4.820887e-32
## 194 03040                       Spliceosome            4.384401e-26
## 186 03008 Ribosome biogenesis in eukaryotes            1.118367e-16
## 169 01100                Metabolic pathways            1.872411e-10
##     under_represented_pvalue numDEInCat numInCat
## 187                        1         76       87
## 188                        1        108      157
## 194                        1         86      124
## 186                        1         53       76
## 169                        1        367     1142
```
---

# Gene ontology and functional testing. GREAT method.

In addition to a standard enrichment tests, methods have been implemented specifically for ChIP-seq. Many of these tools aim to incorporate peaks distal to genes into their enrichment testing such as the popular [GREAT](http://bejerano.stanford.edu/great/public/html/splash.php) toolset.

Incorporating distal peaks by rules such as nearest gene results in some genes having a higher chance of being selected and hence some genesets as a whole having a higher chance of having its members selected.

[GREAT](http://bejerano.stanford.edu/great/public/html/splash.php) defines regulatory regions for each, individual gene and compares the proportion of peaks mapping to a geneset's regulatory regions to the proportion of the genome occupied by geneset's regulatory regions.

i.e. If a gene set's regulatory regions account for 1% of the genome then one might expect 1% of peaks to overlap these regions by chance.
---
rGREAT - R interface to GREAT server.
=========================================================

We can use the GREAT Bioconductor interface available in the rGREAT package. 


```r
library(rGREAT)
```
---
Gene ontology and functional testing. GREAT method.
=========================================================

To submit jobs we can use our GRanges of Myc peaks and specify a genome with the **submitGreatJob** function.

This function returns a GreatJob object containing a reference to our results on the GREAT server. To review the categories of results available we can use the availableCategories function on our GreatJob object.


```r
great_Job &lt;- submitGreatJob(macsPeaks_GR, species = "mm10")
availableCategories(great_Job)
```

```
## [1] "GO"                               "Phenotype Data and Human Disease"
## [3] "Pathway Data"                     "Gene Expression"                 
## [5] "Regulatory Motifs"                "Gene Families"
```
---
Gene ontology and functional testing. GREAT method.
=========================================================

The results table can be retrieved using the getEnrichmentTables function and specifying which tables we wish to review.

Here we retrieve the results tables for the "Regulatory Motifs" genesets which contains 2 seperate database results.


```r
great_ResultTable = getEnrichmentTables(great_Job,
                                        category="Regulatory Motifs")
names(great_ResultTable)
```

```
## [1] "MSigDB Predicted Promoter Motifs" "MSigDB miRNA Motifs"
```
---

Gene ontology and functional testing. GREAT method.
=========================================================

Now we can review the enrichment of our genes with Myc peaks in their TSS for the "MSigDB Predicted Promoter Motifs" genesets.


```r
msigProMotifs &lt;- great_ResultTable[["MSigDB Predicted Promoter Motifs"]]
msigProMotifs[1:4, ]
```

```
##                     ID
## 1   SCGGAAGY_V$ELK1_02
## 2     GGGCGGR_V$SP1_Q6
## 3      CACGTG_V$MYC_Q2
## 4 RCGCANGCGY_V$NRF1_Q6
##                                                                              name
## 1                Motif SCGGAAGY matches ELK1: ELK1, member of ETS oncogene family
## 2                             Motif GGGCGGR matches SP1: Sp1 transcription factor
## 3 Motif CACGTG matches MYC: v-myc myelocytomatosis viral oncogene homolog (avian)
## 4                     Motif RCGCANGCGY matches NRF1: nuclear respiratory factor 1
##   Binom_Genome_Fraction Binom_Expected Binom_Observed_Region_Hits
## 1            0.05912876       814.6169                       1586
## 2            0.20132920      2773.7130                       3782
## 3            0.07555623      1040.9380                       1638
## 4            0.05163166       711.3293                       1195
##   Binom_Fold_Enrichment Binom_Region_Set_Coverage Binom_Raw_PValue
## 1              1.946928                0.11511940    1.738355e-136
## 2              1.363515                0.27451550     1.823467e-94
## 3              1.573580                0.11889380     1.110696e-71
## 4              1.679953                0.08673877     2.182812e-65
##   Hyper_Total_Genes Hyper_Expected Hyper_Observed_Gene_Hits
## 1              1069       502.9698                      806
## 2              2689      1265.1880                     1812
## 3               941       442.7452                      695
## 4               822       386.7551                      606
##   Hyper_Fold_Enrichment Hyper_Gene_Set_Coverage Hyper_Term_Gene_Coverage
## 1              1.602482              0.07821446                0.7539757
## 2              1.432198              0.17583700                0.6738565
## 3              1.569752              0.06744299                0.7385760
## 4              1.566883              0.05880640                0.7372263
##   Hyper_Raw_PValue
## 1     1.739538e-83
## 2    5.523247e-114
## 3     1.936613e-65
## 4     1.614352e-56
```

---

# Motifs

A common practice in transcription factor ChIP-seq is to investigate the motifs enriched under peaks. 

Denovo motif enrichment can be performed in R/Bioconductor but this can be very time consuming. Here we will use the Meme-ChIP suite available online to identify denovo motifs.

Meme-ChIP requires a FASTA file of sequences under peaks as input so we extract this using the **BSgenome** package.

---

# Extracting sequences under regions


First we need to load the BSgenome object for the genome we are working on, UCSC's mm10 build for the mouse genome, **BSgenome.Mmusculus.UCSC.mm10**.





```r
library(BSgenome)
library(BSgenome.Mmusculus.UCSC.mm10)
BSgenome.Mmusculus.UCSC.mm10
```

```
## Mouse genome:
## # organism: Mus musculus (Mouse)
## # provider: UCSC
## # provider version: mm10
## # release date: Dec. 2011
## # release name: Genome Reference Consortium GRCm38
## # 66 sequences:
## #   chr1                 chr2                 chr3                
## #   chr4                 chr5                 chr6                
## #   chr7                 chr8                 chr9                
## #   chr10                chr11                chr12               
## #   chr13                chr14                chr15               
## #   ...                  ...                  ...                 
## #   chrUn_GL456372       chrUn_GL456378       chrUn_GL456379      
## #   chrUn_GL456381       chrUn_GL456382       chrUn_GL456383      
## #   chrUn_GL456385       chrUn_GL456387       chrUn_GL456389      
## #   chrUn_GL456390       chrUn_GL456392       chrUn_GL456393      
## #   chrUn_GL456394       chrUn_GL456396       chrUn_JH584304      
## # (use 'seqnames()' to see all the sequence names, use the '$' or '[['
## # operator to access a given sequence)
```
---

#Extracting sequences under regions


The motif for the ChIP-ed transcription factor should in the centre of a peak. Meme-ChIP will trim our peaks to a common length internally if sequences are of different length.

It is best therefore to provide a peak set resized to a common length.


```r
macsSummits_GR &lt;- GRanges(seqnames(macsPeaks_GR),
                          IRanges(macsPeaks_GR$abs_summit,
                                  macsPeaks_GR$abs_summit),
                          score=macsPeaks_GR$fold_enrichment)
macsSummits_GR &lt;- resize(macsSummits_GR,100,fix="center")
```

---
#Extracting sequences under regions

We now have a GRanges, centred on the summit, highest point of signal for every peak.


```r
macsSummits_GR
```

```
## GRanges object with 13777 ranges and 1 metadata column:
##           seqnames                 ranges strand |     score
##              &lt;Rle&gt;              &lt;IRanges&gt;  &lt;Rle&gt; | &lt;numeric&gt;
##       [1]     chr1     [4785515, 4785614]      * |   5.23296
##       [2]     chr1     [5083072, 5083171]      * |   4.26417
##       [3]     chr1     [7397785, 7397884]      * |    9.8458
##       [4]     chr1     [9545350, 9545449]      * |  11.85079
##       [5]     chr1     [9700928, 9701027]      * |   5.14291
##       ...      ...                    ...    ... .       ...
##   [13773]     chrX [168674050, 168674149]      * |     5.217
##   [13774]     chrX [169047705, 169047804]      * |   5.33257
##   [13775]     chrX [169320320, 169320419]      * |    4.6703
##   [13776]     chrY [  1245745,   1245844]      * |    4.0455
##   [13777]     chrY [  1286577,   1286676]      * |   5.00143
##   -------
##   seqinfo: 21 sequences from an unspecified genome; no seqlengths
```

---
#Extracting sequences under regions


Once we have recentered our peaks we can use the **getSeq** function with our GRanges of resized common peaks and the BSgenome object for mm10.

The **getSeq** function returns a *DNAStringSet* object containing sequences under peaks. 


```r
peaksSequences &lt;- getSeq(BSgenome.Mmusculus.UCSC.mm10,
                         macsSummits_GR)
names(peaksSequences) &lt;- paste0(seqnames(macsSummits_GR),":",
                                         start(macsSummits_GR),
                                         "-",
                                         end(macsSummits_GR))

peaksSequences[1:2,]
```

```
##   A DNAStringSet instance of length 2
##     width seq                                          names               
## [1]   100 CGTCCATCGCCAGAGTGACGC...GGCTTCAGGTTGGCCAGGCT chr1:4785515-4785614
## [2]   100 CCGCCCTCAGCTGCGGTCACG...GTGAGGCTCGCAACGTCTCC chr1:5083072-5083171
```
---
# Writing to FASTA file


The *writeXStringSet* function allows the user to write DNA/RNA/AA(aminoacid)StringSet objects out to file. 

By default the *writeXStringSet* function writes the sequence information in FASTA format (as required for Meme-ChIP).


```r
writeXStringSet(peaksSequences,file="mycMel_rep1.fa")
```

---

Now the file "mycMel_rep1.fa" contains sequences around the geometric centre of peaks suitable for Motif analysis in Meme-ChIP. 

In your own work you will typically run this from your own laptop with Meme installed locally but today we will upload our generated FASTA file to their [web portal](http://meme-suite.org/tools/meme-chip). 

Results files from Meme-ChIP can be found [here](http://rockefelleruniversity.github.io/myc_Meme_Example/meme-chip.html)

---
# Parsing back fimo results

We can retrieve the locations of Myc motifs identified in Meme-ChIP from the Fimo output.

Fimo reports Myc motif locations as a GFF3 file which we should be able to visualise in IGV. 
Sadly, this GFF file's naming conventions cause only a fraction of motifs to be reported.

&lt;div align="center"&gt;
&lt;img src="imgs/fimoBad.png" alt="offset" height="300" width="600"&gt;
&lt;/div&gt;

---
# Fimo to R.

Fortunately we can parse our motif's GFF file into R and address this using the **import()** function in  the **rtracklayer** package.


```r
library(rtracklayer)
motifGFF &lt;- import("~/Downloads/fimo.gff")
```
---
# Fimo to valid GFF3.

We can give the sequences some more sensible names and export the GFF to file to visualise in IGV.


```r
motifGFF$Name &lt;- paste0(seqnames(motifGFF),":",
                        start(motifGFF),"-",end(motifGFF))
motifGFF$ID &lt;- paste0(seqnames(motifGFF),":",
                      start(motifGFF),"-",end(motifGFF))
export.gff3(motifGFF,con="~/Downloads/fimoUpdated.gff")
```

&lt;div align="center"&gt;
&lt;img src="imgs/fimoGood.png" alt="offset" height="250" width="600"&gt;
&lt;/div&gt;


---
&lt;!-- --- --&gt;
&lt;!-- # High confidence peaks --&gt;

&lt;!-- As we discussed in our last session, ChIPseq data will often contain artefact signal and noise. Following the work by the Encode consortium, it is becoming more standard practice to have replicate samples for ChIP-seq. --&gt;

&lt;!-- One approach to selecting reproducible peaks in ChIPseq is to identify peaks which are present in the majority of replicates. --&gt;

&lt;!-- We can first read in the other replicate dataset for MEL Myc ChIPseq below. --&gt;

&lt;!-- ```{r, echo=TRUE,collapse=F} --&gt;

&lt;!-- library(GenomicRanges) --&gt;
&lt;!-- library(TxDb.Mmusculus.UCSC.mm10.knownGene) --&gt;
&lt;!-- library(ChIPseeker) --&gt;
&lt;!-- macsPeaks &lt;- "data/peaks/Mel_2_peaks.xls" --&gt;
&lt;!-- macsPeaks_DF2 &lt;- read.delim(macsPeaks,comment.char="#") --&gt;
&lt;!-- macsPeaks_GR2 &lt;- GRanges( --&gt;
&lt;!--  seqnames=macsPeaks_DF2[,"chr"], --&gt;
&lt;!--  IRanges(macsPeaks_DF2[,"start"],macsPeaks_DF2[,"end"]) --&gt;
&lt;!-- ) --&gt;
&lt;!-- mcols(macsPeaks_GR2) &lt;- macsPeaks_DF2[,c("abs_summit", "fold_enrichment")] --&gt;
&lt;!-- ``` --&gt;

&lt;!-- --- --&gt;
&lt;!-- # Manipulating Peak Sets - Finding Common peaks --&gt;


&lt;!-- When looking at peaks which occur in both samples it is clear that the number of peaks in first replicate overlapping those in second is different from number of second replicate peaks overlapping first. --&gt;

&lt;!-- This is because 2 peaks from one replicate may overlap 1 peak in the other replicate. --&gt;

&lt;!-- ```{r,eval=T,echo=T, eval=T, echo=T, warning=FALSE} --&gt;
&lt;!-- firstANDsecondPeakSets &lt;- macsPeaks_GR[macsPeaks_GR %over% macsPeaks_GR2] --&gt;
&lt;!-- secondANDfirstPeakSets &lt;- macsPeaks_GR2[macsPeaks_GR2 %over% macsPeaks_GR] --&gt;

&lt;!-- length(firstANDsecondPeakSets) --&gt;
&lt;!-- length(secondANDfirstPeakSets) --&gt;
&lt;!-- ``` --&gt;

&lt;!-- --- --&gt;
&lt;!-- ![alt text](imgs/oneToMany.png) --&gt;

&lt;!-- --- --&gt;
&lt;!-- # Manipulating Peak Sets - Finding Common peaks --&gt;


&lt;!-- A common step with finding overlapping transcription factor peaks is to reduce peaksets to single non-overlapping peakset before interrogating whether a peak occurred in a sample. --&gt;

&lt;!-- This allows for a single peak set to be used as a consensus peakset between replicates. --&gt;


&lt;!-- ```{r,eval=T,echo=T, eval=T, echo=T, warning=FALSE} --&gt;
&lt;!-- allPeaks &lt;- c(macsPeaks_GR,macsPeaks_GR2) --&gt;
&lt;!-- allPeaksReduced &lt;- reduce(allPeaks) --&gt;
&lt;!-- length(allPeaks) --&gt;
&lt;!-- length(allPeaksReduced) --&gt;
&lt;!-- ``` --&gt;

&lt;!-- --- --&gt;
&lt;!-- ![alt text](imgs/mel_Flattened.png) --&gt;


&lt;!-- --- --&gt;

&lt;!-- Now we can use a logical expression to subset our reduced/flattened peak set to those overlapping peaks in both the first and second replicate. --&gt;

&lt;!-- ```{r,eval=T,echo=T, eval=T, echo=T, warning=FALSE} --&gt;
&lt;!-- commonPeaks &lt;- allPeaksReduced[allPeaksReduced %over% macsPeaks_GR  --&gt;
&lt;!--                                &amp; allPeaksReduced %over% macsPeaks_GR2] --&gt;
&lt;!-- length(commonPeaks) --&gt;
&lt;!-- ``` --&gt;

&lt;!-- --- --&gt;
&lt;!-- ![alt text](imgs/Ch12_highcon.png) --&gt;

---

# Time for an exercise.

[Link_to_exercises](../../Exercises/chipseq_part3_exercises.html)

[Link_to_answers](../../Answers/chipseq_part3_answers.html)
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
  }
});
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
